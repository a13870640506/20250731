# 基于Transformer神经网络的隧道数字孪生系统

## 项目简介

本项目是一个基于Transformer神经网络的隧道数字孪生系统，专注于隧道围岩参数与位移关系的正演分析。系统采用先进的Transformer架构，能够有效建立围岩参数与隧道位移之间的映射关系，提供高精度的预测结果。

## 功能概述
- **超参数优化**：利用 Optuna 对模型超参数进行贝叶斯优化。
- **模型训练**：上传并划分数据集，训练 Transformer 模型并生成可视化曲线。
- **隧道位移预测**：使用训练好的模型预测围岩位移。
- **结果可视化**：查看训练曲线、预测对比及历史记录。
- **数据集管理**：上传、浏览和下载历史数据集。

## 系统架构

### 前端技术栈
- Vue 3
- Element Plus
- Vite

### 后端技术栈
- Python Flask
- PyTorch
- NumPy, Pandas, Scikit-learn
- Optuna (贝叶斯优化)
- Matplotlib (数据可视化)

## 主要功能

### 1. 模型训练
- 上传围岩参数与位移数据集
- 配置模型训练参数
- 训练Transformer神经网络模型
- 可视化训练过程和结果

### 2. 模型超参数优化
- 设置超参数优化范围
- 使用贝叶斯优化方法寻找最优超参数
- 可视化优化过程和结果

### 3. 隧道位移预测
- 输入围岩参数（泊松比、内摩擦角、粘聚力、剪胀角、弹性模量）
- 预测对应的隧道位移（拱顶下沉1、拱顶下沉2、周边收敛1、周边收敛2、拱脚下沉）
- 可视化预测结果

### 4. 数据可视化
- 训练结果详情：查看模型训练过程和评估指标
- 结果对比：比较不同模型或参数设置下的预测结果
- 历史数据集：浏览和分析历史训练数据

## 安装与运行

### 前端部分

```bash
# 进入前端目录
cd 前端代码

# 安装依赖
npm install

# 启动开发服务器
npm run dev

# 构建生产版本
npm run build
```

### 后端部分

```bash
# 进入后端目录
cd 后端代码

# 创建虚拟环境
python -m venv venv

# 激活虚拟环境
# Windows
venv\Scripts\activate
# Linux/Mac
source venv/bin/activate

# 安装依赖
pip install -r requirements.txt

# 启动服务器
python app.py
```

## 数据格式

系统接受CSV格式的数据文件，包含以下字段：
- 输入参数（5个）：泊松比、内摩擦角（°）、粘聚力（Mpa）、剪胀角（°）、弹性模量（MPa）
- 输出参数（5个）：拱顶下沉1（mm）、拱顶下沉2（mm）、周边收敛1（mm）、周边收敛2（mm）、拱脚下沉（mm）

## 模型架构

系统采用基于Transformer的时序预测模型（TimeSeriesTransformer），主要特点包括：
- 自注意力机制，有效捕捉特征间的复杂关系
- 多头注意力机制，从不同表示子空间学习特征
- 位置编码，保留序列中的位置信息
- 前馈神经网络，增强模型的非线性表达能力

## 正演分析原理

本系统采用正演分析方法，即从围岩参数（输入）推导隧道位移（输出）。系统将围岩参数作为输入特征，通过Transformer神经网络建立非线性映射关系，预测对应的隧道位移响应。这种方法能够有效捕捉围岩参数与隧道位移之间的复杂关系，为隧道工程设计和施工提供科学依据。

## 系统截图

### 模型训练
![模型训练](screenshots/model_training.png)

### 模型超参数优化
![模型超参数优化](screenshots/param_optimization.png)

### 隧道位移预测
![隧道位移预测](screenshots/tunnel_predict.png)

### 数据可视化
![数据可视化](screenshots/data_visualization.png)

## 开发团队

- 项目指导：XXX教授
- 开发人员：XXX

前端默认运行在 `http://localhost:5173`，后端在 `http://127.0.0.1:8000`。

## 数据说明
系统使用 CSV 文件作为数据集，包含以下字段：
- **输入特征**：泊松比、内摩擦角、粘聚力、剪胀角、弹性模量
- **输出位移**：拱顶下沉1、拱顶下沉2、周边收敛1、周边收敛2、拱脚下沉

## 许可证
本项目代码仅用于学习与研究目的，未经许可请勿用于商业用途。